#NodeJs对excel的读写操作
中间件excel读取excel中的内容时会将日期转换为文本格式,文本格式的日期是基于1900年1月1日开始计算的,一天加1,这种格式的数据我们是无法使用的,

excel处理数据的输出为:

    {
        "v": "单元格的原始值",
        "w": "单元格格式化之后的文本",
        "t": "数据类型",
        "f": "cell formula",
        "r": "富文本",
        "h": "富文本的HTML表示形式",
        "c": "注释",
        "z": "数字格式化模板",
        "l": "如果当前单元格内容是超链接，这里存储了超链接内容",
        "s": "单元格样式"
    }

xlsx中间件中的xlsx.js文件的11506行的sheet_to_json方法是对excel数据的处理

11550行val.v获取的是原始值,日期格式为文本格式,将其改为val.w后能够获取到正常的日期格式

excel.js文件为使用node-xlsx获取excel内容的代码

test.js文件为使用xlsx获取excel内容的代码

test.js中解决了IO异步的问题,正确的把数据插入数据库中